
dxch_test_nocuda: libmetamorph_nocuda.so
	gcc dxch_bootstrapper.c -I ./ -D WITH_OPENCL -D WITH_TIMERS -L ./ -L /usr/local/cuda/lib64 -lmetamorph_nocuda -lmetamorph_opencl_core -o dxch_test_nocuda

red_test_nocuda: libmetamorph_nocuda.so
	gcc red_bootstrapper.c -I ./ -D WITH_OPENCL -D WITH_TIMERS -D WITH_FORTRAN -L ./ -L /usr/local/cuda/lib64 -lmetamorph_nocuda -lmetamorph_opencl_core -o red_test_nocuda

libmetamorph_nocuda.so: libmetamorph_opencl_core.so metamorph.c
	gcc metamorph.c metamorph_timers.c metamorph_fortran_compat.c -fPIC -shared -D WITH_OPENCL -D WITH_TIMERS -D WITH_FORTRAN -I ./ -L ./ -L /usr/local/cuda/lib64 -lmetamorph_opencl_core -lOpenCL -o libmetamorph_nocuda.so

libmetamorph_opencl_core.so:
	g++ metamorph_opencl_core.cpp -g -fPIC -shared -I ./ -L /usr/local/cuda/lib64 -lOpenCL -o libmetamorph_opencl_core.so -D __OPENCLCC__

red_test_nocuda_DEBUG: libmetamorph_nocuda_DEBUG.so
	gcc red_bootstrapper.c -I ./ -D WITH_OPENCL -D WITH_OPENMP -D WITH_TIMERS -D WITH_FORTRAN -L ./ -L /usr/local/cuda/lib64 -lmetamorph_nocuda_DEBUG -lmetamorph_opencl_core_DEBUG -o red_test_nocuda_DEBUG -g -O0

libmetamorph_nocuda_DEBUG.so: libmetamorph_opencl_core_DEBUG.so metamorph.c
	gcc metamorph.c metamorph_timers.c metamorph_fortran_compat.c -fPIC -shared -D WITH_OPENCL -D WITH_OPENMP -D WITH_TIMERS -D WITH_FORTRAN -I ./ -L ./ -L /usr/local/cuda/lib64 -lmetamorph_opencl_core_DEBUG -lOpenCL -o libmetamorph_nocuda_DEBUG.so -g -O0

libmetamorph_opencl_core_DEBUG.so:
	g++ metamorph_opencl_core.cpp -fPIC -shared -I ./ -L /usr/local/cuda/lib64 -lOpenCL -o libmetamorph_opencl_core_DEBUG.so -D __OPENCLCC__ -g -O0
	
clean:
	rm libmetamorph*.so *.mod dxch_test_nocuda xch_test red_test red_test_nocuda red_test_cuda red_test_omp red_test_notimers red_test_nocuda_notimers red_test_fortran red_test_fortran_nocuda red_test_fortran_notimers red_test_fortran_nocuda_notimers red_test_DEBUG red_test_nocuda_DEBUG red_test_cuda_DEBUG red_test_omp_DEBUG red_test_notimers_DEBUG red_test_nocuda_notimers_DEBUG red_test_fortran_DEBUG red_test_fortran_nocuda_DEBUG red_test_fortran_notimers_DEBUG red_test_fortran_nocuda_notimers_DEBUG
